g.V().hasLabel('Comment').has('creationDate',between($startDate,$endDate))
.not(outE('rootPost')).as('comment')
.repeat(__.out('replyOf')).until(__.hasLabel('Post')).as('post')
.select('comment','post')
.project('creationDate','commentId','postId')
.by(select('comment').values('creationDate'))
.by(select('comment').id())
.by(select('post').id())
.io('$dataDir/Comment_rootPost_Post_$taskIndex.csv').write().with(__.map{it.get().get('creationDate')+"|"+it.get().get('commentId')+"|"+it.get().get('postId')})