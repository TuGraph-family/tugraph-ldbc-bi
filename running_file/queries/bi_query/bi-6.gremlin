g.V().hasLabel('Tag').has('name','$tag')
.in('hasTag')
.hasLabel('Comment','Post')
.project('person1.id','subMsgPopularityScore')
.by(__.out('hasCreator').id())
.by(__.in('likes').dedup().values('popularityScore').sum())
.group()
.by(select('person1.id'))
.by(coalesce(select('subMsgPopularityScore'),constant(0)).sum()).unfold()
.project('person1.id','authorityScore')
.by(select(keys))
.by(select(values))
.order().by('authorityScore',desc).by('person1.id',asc)
.limit(100)